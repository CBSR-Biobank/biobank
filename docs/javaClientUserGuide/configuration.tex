\chapter{Configuration}
\label{chap:configuration}
The configuration settings for the Java Client can be found by selecting
\texttt{Configuration} $\to$ \texttt{Preferences} from the main menu.
    \begin{figure}[H]
      \centering
      \scalebox{0.5}
      { \includegraphics*{screenshots/configuration/preferences_dialog} }
      \caption{Configuration preferences dialog box.}
      \label{fig:preferences_dialog}
    \end{figure}
A configuration page can be selected by clicking on a node on the
tree on the left hand side of the dialog box. The \texttt{filter text} box, see
arrow labelled \emph{1} in figure \ref{fig:preferences_dialog}, can
be used to quickly find a configuration page by typing the name of the page in
whole or in part.

The following sections discuss the configuration pages in detail.

\section{Automatic Updates}
\label{sec:automatic_updates}
The Java Client has the capability of detecting when a new version of the
software has been made available by the software design team. The settings on
this page allow the user to specify when updates will be searched for, when to
download them, and how to notify the user when they are found.

\section{General}
The settings on this page are general to the application.
\begin{figure}[H]
  \centering
  \scalebox{0.5}
	   { \includegraphics*{screenshots/configuration/prefs_general} }
	   \caption{General preferences.}
	   \label{fig:prefs_general}
\end{figure}
\begin{description}
\item[Show software version in main window title] the Java Client's software
  version can be displayed in the window's title bar by checking this
  box.\textit{Note that this option is only required by technicians when they
    are testing new versions of the software}.
\item[Show heap status] the \emph{heap status} can be displayed in the main
  window by checking this box. The heap status gives an indication of the
  memory used by the application. \textit{This option is in place for the
    software designers and is not required for normal use}.
\end{description}

\section{Issue Tracker}
The application has the capability of sending \emph{Problem Report} emails to
the software design team\footnote{\texttt{Help -> Send Error Email} from the
  main menu}. The error emails have application state information attached to
aid team in resolving potential problems. The settings on this page are the
settings used to send the emails to the team.
    \begin{figure}[H]
      \centering
      \scalebox{0.5}
      { \includegraphics*{screenshots/configuration/prefs_issue_tracker} }
      \caption{Issue tracker preferences.}
      \label{fig:prefs_issue_tracker}
    \end{figure}
\begin{description}
  \item[Tracker email] The email address to send problem reports to.
  \item[SMTP server] The SMTP mail server to use when sending emails.
  \item[SMTP server port] The SMTP server port.
  \item[SMTP server username] The user name to use with the SMTP server.
  \item[SMTP server password] The password to use with the SMTP server.
\end{description}
\textit{Users should not modify these settings unless requested to by the software
  design team}.

\section{Link \ Assign}
These settings are used when scanning and decoding pallets and linking them to
patients or container locations.
    \begin{figure}[H]
      \centering
      \scalebox{0.5}
      { \includegraphics*{screenshots/configuration/prefs_link_assign} }
      \caption{Scan link / Assign preferences.}
      \label{fig:prefs_link_assign}
    \end{figure}
\begin{description}
  \item[Confirm Barcode and Cancel Barcode] To speed up processing of samples,
    a handheld barcode scanner can be used to quickly enter information into
    the application. Barcodes with the corresponding words can be printed and
    then scanned when required by the application (See sections
    \ref{sec:scan_link}, \ref{sec:scan_assign} and
    \ref{sec:cabinet_scan_link_assign}). The \textbf{Confirm Barcode} and
    \textbf{Cancel Barcode} settings contain the text encoded into these
    barcodes when they were created. \todo[size=\small]{Need an appendix with
      instructions on how to create these barcodes.}%
  \item [Save activity logs into a file and Path for activity logs files] When
    processing patients, the actions taken by the user can be logged and saved
    to files on disc. This section allows the user to activate saving this
    logging to disc and specify the path on disc where the files are will be
    saved.
  \item[\textbf{Ask to print activity log}] When a scan link or scan assign
    session is over the user can be prompted to print the activity logs. This
    setting enables or disables the prompting.
\end{description}

\section{Scanning and Decoding}
\label{sec:scanning_and_decoding}
The settings on this page allow the user to specify the scanning and
decoding parameters used when decoding pallet images.
    \begin{figure}[H]
      \centering
      \scalebox{0.5}
      { \includegraphics*{screenshots/configuration/prefs_scanning_and_decoding} }
      \caption{Scanning and Decoding preferences.}
      \label{fig:prefs_scanning_and_decoding}
    \end{figure}
\begin{description}
  \item[Select Scanner] This button is used to select the scanner that will be
    used to scan 96 well pallets. The dialog box shown in figure
    \ref{fig:prefs_select_source} is shown when the button is pressed.
    \begin{figure}[H]
      \centering
      \scalebox{0.5}
      { \includegraphics*{screenshots/configuration/prefs_select_source} }
      \caption{Selecting a scanning source.}
      \label{fig:prefs_select_source}
    \end{figure}
  \item[Driver Type] The type of driver that was selected when the \fbox{Select
    Scanner} button was pressed. Normally, the application will attempt to
    determine the driver type as soon as the user makes the selection, but
    sometimes the application does not select the correct type. Use the check
    boxes here to override what the application selected if it was incorrect.
  \item[DPI] The \emph{Dots per Inch} used by the scanner for scanning
    images. For best results use 600 DPI.
  \item[Brightness] The brightness setting to be used when scanning
    images. This parameter does not work on Hewlett-Packard scanners when using
    the WIA based driver.
  \item[Contrast] The contrast setting to be used when scanning
    images. This parameter does not work on Hewlett-Packard scanners when using
    the WIA based driver.
\end{description}

\subsection{Decoding Parameters}
On the preferences dialog window, if there is a "plus" symbol next to the
\emph{Scanning and Decoding} node, press it to expand the sub tree.

These settings control how the software decodes the sample tubes imprinted with
DataMatrix 2D barcodes.
    \begin{figure}[H]
      \centering
      \scalebox{0.5}
      { \includegraphics*{screenshots/configuration/prefs_decoding_parms} }
      \caption{Decoding preferences.}
      \label{fig:prefs_decoding_parms}
    \end{figure}
\begin{description}
  \item[Decode Library Debug Level] The decoding software library can output
    debugging information to a log file. When this value is zero there is no
    debugging information stored in the log file. Possible values are 0 through
    9. The higher the value the more detailed the debugging information.
  \item[Decode Edge Threshold] Set the minimum edge threshold as a percentage
    of maximum. For example, an edge between a pure white and pure black pixel
    would have an intensity of 100.  Edges with intensities below the indicated
    threshold will be ignored by the decoding process. Lowering the threshold
    will increase the amount of work to be done, but may be necessary for low
    contrast or blurry images. The default and recommended value is \emph{5}.
  \item[Decode Square Deviation] Maximum deviation (in degrees) from squareness
    between adjacent barcode sides. The default and recommended value is
    \emph{N=15} and is meant for scanned images. Barcode regions found with
    corners \emph{<(90-N)} or \emph{>(90+N)} will be ignored by the decoder.
  \item[Decode Corrections] The number of corrections to make while
    decoding. The default and recommended value is 10.
  \item[Decode Scan Gap] The scan grid gap size in inches. The default and
    recommended value is \emph{0.085}.
  \item[Decode Cell Distance] The distance in inches between tubes.The default
    and recommended value is \emph{0.345} for NUNC pallets.
\end{description}

\subsection{Decoding Profiles}
On the preferences dialog window, if there is a "plus" symbol next to the
\emph{Scanning and Decoding} node, press it to expand the sub tree.

This page allows the user to define \emph{Decoding Profiles}. These profiles
allow the user define a sub set of tubes to decoded when an image of a pallet
is scanned. Scanning profiles can be used during scan link and scan assign (see
sections \ref{sec:scan_link} and \ref{sec:scan_assign}).
    \begin{figure}[H]
      \centering
      \scalebox{0.45}
      { \includegraphics*{screenshots/configuration/prefs_decoding_profiles} }
      \caption{Decoding profiles preferences.}
      \label{fig:prefs_decoding_profiles}
    \end{figure}
For example: the user may wish to only decode every other row on a pallet. Once
the profile is created it can be used at scan link and scan assign time and
only the cells activated in the profile will be decoded. If 2D barcodes are
found in the cells not active in the profile, the user will be given a warning
message.

To create a new profile follow these instructions:
\begin{enumerate}
  \item Press the \fbox{Add...} button. A dialog box pops up requesting a name
    for the new profile. Enter an appropriate name and press the \fbox{OK}
    button.
  \item Now select each cell that should be part of the profile (see cells with
    a checkmark in Figure \ref{fig:prefs_decoding_profiles}). When done
    selecting cells press the \fbox{Apply} button.
\end{enumerate}

\subsection{Plate Positions}
On the preferences dialog window, if there is a "plus" symbol next to the
\emph{Scanning and Decoding} node, press it to expand the sub tree.
    \begin{figure}[H]
      \centering
      \scalebox{0.5}
      { \includegraphics*{screenshots/configuration/plate1_definition} }
      \caption{Configuring a plate position.}
      \label{fig:plate1_definition}
    \end{figure}

To define a pallet scanning region do the following:
\begin{enumerate}
  \item Place a pallet that contains tubes on the flatbed scanner. Ensure the
    top edge of the pallet is touching the top of the scanning region, and the right
    edge of the pallet is touching the right margin. Ensure the 12 columns
    are vertical and the 8 rows are horizontal.
  \item Select the plate region you are going to define.  If it is the first
    select \emph{Plate 1 Position}.
  \item Click on the "Enable" box.
  \item Press the \fbox{Scan} button. Now wait for the scanner to scan the entire
    flatbed.
    \begin{figure}[H]
      \centering
      \scalebox{0.5}
      { \includegraphics*{screenshots/configuration/sample_flatbed_scan} }
      \caption{Sample flatbed scan.}
      \label{fig:sample_flatbed_scan}
    \end{figure}
  \item Once the scan is done, you will see something similar to Figure
    \ref{fig:sample_flatbed_scan}. The image shown on the right hand side is
    the image taken by the scanner and superimposed is a grid with 8 rows and
    12 columns. The cell coloured in cyan should correspond to tube in row A and
    column 1.
  \item Under orientation select "Landscape".
  \item You can adjust the size of the grid using the mouse. If you move the
    mouse to one of the corners or one of the edges you can resize the grid by
    holding down the left button on the mouse. The whole grid can be moved by
    pressing the left mouse button while hovering inside the grid.
  \item Once the grid cells are aligned with each tube press the \fbox{OK} button
    (see Figure \ref{fig:plate1_grid_ready}). The wheel on the mouse can be
    used to make the cells smaller or bigger (this is referred to as the
    \emph{Cell Gap}).
    \begin{figure}[H]
      \centering
      \scalebox{0.5}
      { \includegraphics*{screenshots/configuration/plate1_grid_ready} }
      \caption{Grid aligned with tubes.}
      \label{fig:plate1_grid_ready}
    \end{figure}
  \item Repeat from step 2 to define any more pallet scanning regions.
  \item Usually only one pallet scanning region is required for normal
    operation of the software.
\end{enumerate}
Figure \ref{fig:plate2_grid_ready} shows an example of how \emph{Plate 2} can
be defined. Here Plate 2 is touching the top and the left margin of
the of the flatbed region. The plate on the left of the image is where Plate 1
is defined.
    \begin{figure}[H]
      \centering
      \scalebox{0.5}
      { \includegraphics*{screenshots/configuration/plate2_grid_ready} }
      \caption{Plate 2 grid aligned with tubes.}
      \label{fig:plate2_grid_ready}
    \end{figure}
Note that cell A1 should be at the \emph{Top Left} when configuring a plate in
\textbf{Landscape} orientation and \emph{Top Right} when in \textbf{Portrait}
orientation when looking down at the scanner's flatbed.

To test if your configuration will yield valid decodes use the
\texttt{Scanner -> Decode Plate} from the main menu.
\subsection{Plate Barcodes}
To speed up processing of samples, a handheld barcode scanner can be used to
quickly enter information into the application. Barcodes with the corresponding
words can be printed and then scanned when required by the application (See
sections \ref{sec:scan_link} and \ref{sec:scan_assign}). The \textbf{Plate
  \emph{x} barcode} settings contain the text encoded into these barcodes when
they were created.
    \begin{figure}[H]
      \centering
      \scalebox{0.45}
      { \includegraphics*{screenshots/configuration/prefs_plate_barcodes} }
      \caption{Plate barcode preferences.}
      \label{fig:prefs_plate_barcodes}
    \end{figure}

\section{Servers}
This page contains a list of BioBank2 servers that the Java Client connects to
on a regular basis. This list is used in the login dialog box to aid the user
to quickly select a server. New servers can be added to this list by pressing
the \fbox{New} button. Only the domain name or IP address for the server is
required.
    \begin{figure}[H]
      \centering
      \scalebox{0.45}
      { \includegraphics*{screenshots/configuration/prefs_servers} }
      \caption{Server preferences.}
      \label{fig:prefs_servers}
    \end{figure}

Previously entered servers can also be edited with the \fbox{Edit} button if a
spelling mistake was made.

The order in the list can be rearranged with the \fbox{Up} and \fbox{Down}
buttons to put more frequently accessed servers at the beginning of the list.

